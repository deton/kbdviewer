----------------------------------------------------------------------
         「漢直Win」ver1.26(Windows95/98/NT用T-code入力ツール)

                 製作者: 徳岡宏樹
                 e-mail: tokuoka@taurus.bekkoame.ne.jp
               web page: http://www.bekkoame.ne.jp/~tokuoka/
----------------------------------------------------------------------
●どんなツールか
  「漢直Win」は、T-codeなどの日本語直接入力をWindows上のソフト(メモ帳、
MS-WORDなど)で行うツールです。日本語直接入力とは何か、に関しては上記の
web pageなどでどうぞ。

  漢字のテーブルファイルとしてはT-code用、TUT-codeを同梱していますが、
m(as)mさんのG-codeも上記のweb pageからダウンロードできます。

  「漢直Win」が起動され、「ON」になっている間は、キーボード上の通常の
入力は漢直Winを通して対応する文字に変換され、入力フォーカスを持つ
ウインドウに送られ、文字が入力されます。

　また、いちおう「混ぜ書き変換」もどきもできるので、それなりに難しい漢
字も入力することができます。

  ただし、漢直WinはIMEではないので、「漢直Win」を「OFF」にした状態では
IMEが有効になります。入力方法がわからない漢字はIMEで入力してしまえ、と
いうことです。


●制限事項
　「漢直Win」では、入力フォーカスを持つWindowに向かって、WM_IME_CHAR
メッセージを送っているだけです。したがって、そのメッセージを捨てている
ソフトには入力はできません。

  使用できるソフトは、例えばメモ帳やMS-WORDなどです。その他いろいろな
ソフトで使用できるとは思いますが、残念なことにMule for Win32やDos窓で
はでは使用できません。まあMuleを使用する時には有名なtc.elがあるからい
いでしょう。

  なお、Windows NTで使用する場合には、後述する設定が必要です。

●ソフトの使用条件
  このソフトは使用も配布も自由ですが、このソフトを使用したことによって
何か問題が発生しても、作者も関係者もなんら責任を負いません。自己責任で
使用してください。


●使用方法
　同梱されているファイル(下の「必要なファイル」参照)を同じフォルダに置
いて、kanchoku.exeを実行します。

  ○必要なファイル)
    kanchoku.exe
    kanchoku.ini
    t-code.tbl    ->(注)
    106.key       ->(注)

(注)
　これは106.keyでT-codeを使用する場合です。TUT-codeを使用したり、Dvorak
配列を使用したりするための情報は、後述の「●設定ファイルについて」を参照
して下さい。

●使用方法
  ○起動
    kanchoku.exeのアイコンをダブルクリックすると起動します。

  ○ON,OFFの切り替え
    Ctrlキーを押しながら"\"キーを押すと、「漢直Win」のON、OFFが切り替わり
  ます。ONの状態だとT-codeによる入力が可能となります。
    この切り替えキーは変更できます(「●設定ファイルについて」を参照)。

  ○Onの時の動作
    キーボードの配列には次のような番号をつけています。

          0  1  2  3  4  5  6  7  8  9  41 42 43
           10 11 12 13 14 15 16 17 18 19 44 45 
            20 21 22 23 24 25 26 27 28 29 46 47
             30 31 32 33 34 35 36 37 38 39 48
                       40(スペース)

    つまり、0から39番までが通常T-codeで使用するキーです。その40以降は
    他のコードのために一応番号をつけています。

    これが、「漢直Win」ウインドウでは以下のように並んで表示されます。

                0  1  2  3  4  5  6  7  8  9 
               10 11 12 13 14 15 16 17 18 19 
               20 21 22 23 24 25 26 27 28 29 
               30 31 32 33 34 35 36 37 38 39
                40 41 42 43 44 45 46 47 48

    以降、対応するキーを押した場合について解説します。

    ■「□(四角)」が表示されているキーを押した場合
      「□(四角)」はストロークの続きがあることを意味しているので、画面
      が切り替わります。T-codeでいうと1ストローク目に対応します。

    ■文字が表示されているキーを押した場合
      その文字がアクティブなソフトに入力されます。

    ■「★(星)」が表示されているキーを押した場合
      なんらかの機能です。混ぜ書き変換(後述)や、TUTにおける平・片仮名の
      切り替えなどです。

    ■何も表示されていないキーを押した場合
      元の状態に戻ります。ESCやBSを押した場合も同じです。

●設定ファイルについて
  iniファイルには4つの項目があります。次に示すのがデフォルトです。

  ○HOTKEY=??
    ??のところに、ON,OFFの切り替えに使うキーのキーコードを16進数で入れます。
    デフォルトでは、

    HOTKEY=dc

    となっており Ctrl + "\" での切り替えとなっていますが、 たとえば、

    HOTKEY=be

    とすれば、Ctrl+"."で切り替えになります。

  ○TABLEFILE=??
    ??のところに、テーブルファイルのファイル名を入れます。
    デフォルトでは、

    TABLEFILE=t-code.tbl

    となっており、t-codeのテーブルを使用します。
    例えばTUT-codeを使用したい場合には、

    TABLEFILE=tut-code.tbl

    とします。
    ただし、tut-code.tblが同じフォルダに入っていなければなりません。
    TUT用のテーブル(tut-code.tbl)などは同梱されていませんが、上記の
    web pageからダウンロードできます。

  ○KEYBOARD=??
    ??のところに、キーボードファイルのファイル名を入れます。
    デフォルトでは、

    KEYBOARD=106.key

    となっており、106キーを使用するようになっていますが、例えばDvorak
    配列や101キーを使用したい場合には、

    KEYBOARD=dvorak.key
    KEYBOARD=101.key

    のようにします。

  ○MAZEGAKI=??
    ??のところに、混ぜ書き変換用の辞書ファイル名を入れます。
    混ぜ書き変換については後述します。
    デフォルトでは

    MAZEGAKI=

    となっており、混ぜ書き変換を使用しない設定となっています。
    混ぜ書き辞書として、mazegaki.dicを使用したい場合には、

    MAZEGAKI=mazegaki.dic

    のようにします。ただし、同じフォルダに辞書ファイルmazegaki.dicが
    入っていなければなりません。

  ○USEWMCHAR=??
    ??のところにONと書くと、アプリケーションに送出するメッセージが、
    通常の'WM_IME_CHAR'から'WM_CHAR'に変わります。

    デフォルトでは

    USEWMCHAR=

    となっています。ONにする時は、

    USEWMCHAR=ON

    とします。通常は必要ないですが、ONにしないと使用できない環境が
    あるようです。例えば、MS-Word97をNT4.0で使用するときなどはONにして
    下さい。

  ○XLOC=???
    YLOC=???
    起動した時に出現する座標を指定します。

    (例) 
    (580, 450)の位置に出現
    XLOC=580
    YLOC=450

    なお、(-1,-1)だと特に指定しないことになります。

  ○OFFHIDE=??

    OFFHIDE=ON

    としておくと、OFFの時に表示されなくなります。

    OFFHIDE=

    だと出たままになります。


●混ぜ書き変換
  T-codeにない漢字を入力するために、tc2.0にあるような混ぜ書き変換(もどき)
を用意しました。使用するためには、辞書ファイル(mazegaki.dic)が別途必要です。
  辞書ファイルは、上記のweb pageからダウンロードしてもいいですし、tc2.el用
のやつをSJISに変換してもいいです(多分)。
  また、上記の「●設定ファイルについて」における設定も必要です。

  どういう点が「もどき」なのかというと、
  ・変換モードに切り替えてから変換対象の文字を入力しなくてはいけない
  ・学習しない
  などです。

  ○使用方法
    ・まず、変換する文字列を入力する前に、(23番)(26番)、または(46番)
      のキーを押します。106.keyだと'fj'、または':'になります。
      これを以降「混ぜ書きキー」と呼びます。

    ・すると、いままで「ON」とか「OFF」とか出ていたWindowの中央部分が
      白くなり、入力した文字がそこに縦書きで入るようになります。

    ・読みを入力しおえたら、もう一度「混ぜ書きキー」を押します。
      辞書に該当する項目がある場合には何か起こります。ない時には何も
      起こりません。

      −該当する項目が1つの場合
        その項目が対象のソフトに入力されます。

      −該当する項目が複数の場合
        候補が表示されるので、対応するキーを押すと対象のソフトに入力されます。

    ・読みの入力中に間違えた場合などは、Ctrl + HやBSなどで戻せます。


●TUTに関する補足
  TUTコード(やその他のコード)を使用する場合は、上記の設定ファイル中で指定
して下さい。
  また、TUTのテーブルを使っている場合、44番のキーを押すとひらがな・カタカナ
の切り替えとなります。106キーでは'@'、101キーでは'['に相当します。
  「ON A」「ON B」それぞれの表示が、ひらがな・カタカナを意味します。
  
●ソースの使い方
VC++(たぶん4.2以上)と、gnu makeが使える環境で、

make

でコンパイルできるつもりです。変な環境ですみません。

●不具合、要望など
  不具合や機能拡張の要望があれば
  tokuoka@taurus.bekkoame.ne.jp
までどうぞ。


●履歴
00/6/10  ver1.26
         win98におけるメモリリークを修正

99/?/??  ver1.25
         混ぜ書き変換における、Ctrl+hの不具合を修正

99/5/04  ver1.24
         最小化を禁止(バグ修正)

99/4/18  ver1.23
         出現位置を指定可能に
         OFF時に消えるように

99/4/10  ver1.22
         101.keyを追加

99/2/9   ver1.21
         使用するメッセージを、WM_CHARかWM_IME_CHARか設定可能にする
         (NT + WORDへの対応のため)

99/2/7   ver1.20
         混ぜ書き変換機能実装

99/2/3   ver1.11
         106.keyのバグを修正
         設定ファイルにコメントを入れる

99/2/2   ver1.1
         キーボードファイルを分離
         TUT-codeのテーブル作成

99/1/30  ver1.0 
         簡易マニュアルを書く
